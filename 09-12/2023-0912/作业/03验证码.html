<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>

    </style>
</head>

<body>
    <canvas style="border: 1px solid red;" id="can"></canvas>
    <span id="change">看不清换一张</span>
    <input type="text" id="txt" placeholder="不区分大小写">
    <button id="btn">验证</button>

    <script>
        /** @type {HTMLCanvasElement} */
        var can = document.querySelector("#can");
        var ctx = can.getContext("2d");

        var code = ""

        function myRandom(a, b) {
            // a - b 之前的随机数
            return Math.floor(Math.random() * (b - a + 1)) + a;
        }


        change.onclick = function () {
            ctx.clearRect(0, 0, 300, 150)
            // 线
            for (let i = 0; i < 100; i++) {
                ctx.beginPath();
                // 透明度 0 - 1   
                // myRandom(1,10)  1-10之间的随机数  /10 0.1-1之间的随机数
                ctx.strokeStyle = `rgba(${myRandom(0, 255)},${myRandom(0, 255)},${myRandom(0, 255)},${myRandom(1, 10) / 10})`;
                ctx.lineWidth = myRandom(1, 3);
                ctx.moveTo(myRandom(-100, 400), myRandom(-100, 250));
                ctx.lineTo(myRandom(-100, 400), myRandom(-100, 250));
                ctx.stroke()
            }

            for (let i = 0; i < 100; i++) {
                ctx.beginPath();
                ctx.fillStyle = `rgba(${myRandom(0, 255)},${myRandom(0, 255)},${myRandom(0, 255)},${myRandom(1, 10) / 10})`;
                ctx.arc(myRandom(0, 300), myRandom(0, 250), myRandom(0, 15), 0, Math.PI * 2);
                ctx.fill()
            }

            var str = 'qwertyuiopasdfghjklzxcvbnmQERTYUIOPASDFGHJKLZXCVBNM1234567890';

            for (let i = 0; i < 4; i++) {
                var t = str[myRandom(0, str.length - 1)]
                code += t;
                ctx.font = `${myRandom(30, 80)}px 微软雅黑`;
                ctx.fillStyle = `rgb(${myRandom(0, 255)},${myRandom(0, 255)},${myRandom(0, 255)}`;
                ctx.fillText(t, 45 * (i + 1), 100, 50)
            }


        }
        change.onclick()

        btn.onclick = function () {
            // console.log(txt.value);
            // console.log(code);
            if (txt.value.toLowerCase() == code.toLowerCase()) {
                alert("验证成功")
            } else {
                alert("验证失败")
            }
        }


    </script>
</body>

</html>